{% load i18n %}
{% comment %}
	Loading tests or test suites with current context, libraries and etc.

	{{ root }}   contains '/testsrc/'
	{{ loader }} contains '/testsrc/loader/'
	{{ cases }} contains '/testsrc/cases/'
	{{ jspath }} contains full directory urlpath to test or suite including {{ root }}
	{{ jsfile }} contains full urlpath to test including {{ root }}
	{{ error }} contains errors
	{{ rand }} contains random float number to avoid script caching
{% endcomment %}
<html>
	<head>
		<title>{{ title }}</title>
		<style>
			iframe { width: 99%; height:700px; }
		</style>
		<script type="text/javascript" src="{{ loader }}/jquery-1.5.1.js"></script>
		<script type="text/javascript" src="{{ loader }}/jquery.json-2.2.min.js"></script>
		<script type="text/javascript" src="{{ loader }}/jqueryui/js/jquery-ui-1.8.10.custom.min.js"></script>
		<link rel="stylesheet" type="text/css" href="{{ loader }}/jqueryui/css/redmond/jquery-ui-1.8.10.custom.css">
		
		<link rel="stylesheet" type="text/css" href="{{ loader }}/qunit.css" media="screen" />
		<script type="text/javascript" src="{{ loader }}/qunit.js"></script>
		
		<link rel="stylesheet" type="text/css" href="{{ loader }}/testLoader.css" />
		<script type="text/javascript" src="{{ loader }}/testLoader.js?_={{rand}}"></script>
		<script type="text/javascript" src="{{ jspath }}/.context.js?_={{rand}}"></script>
		<script type="text/javascript">
			$(document).ready(function(){
				if ( typeof context == 'undefined' ) {
					context = { include: [] };
					alert('No context loaded');
				}
				context.libraries = context.libraries || [];
				for ( i in context.libraries ) {
					var jsfile = context.libraries[i];
					var script = document.createElement( 'script' );
					script.type = 'text/javascript';
					script.src = '{{ cases }}/'+jsfile+'?_={{rand}}';
					document.body.appendChild( script );	
				};
				{% if suite %}
				context.include = context.include || [];
				for ( i in context.include ) {
					var jsfile = context.include[i];
					var script = document.createElement( 'script' );
					script.type = 'text/javascript';
					script.src = '{{ jspath }}/'+jsfile+'?_={{rand}}';
					document.body.appendChild( script );	
				};
				{% else %}
				var script = document.createElement( 'script' );
				script.type = 'text/javascript';
				script.src = '{{ jsfile }}?_={{rand}}';
				document.body.appendChild( script );
				{% endif %}
				
				//QUnit.start();
			});
		</script>		  
		<script type="text/javascript">$(document).ready(function() { $( "#tabs" ).tabs(); } );</script>
	</head>
	<body>
		<h1 id="qunit-header">QUnit example</h1>
		<h2 id="qunit-banner"></h2>
		<div id="qunit-testrunner-toolbar"></div>
		<h2 id="qunit-userAgent"></h2>
		<ol id="qunit-tests"></ol>
		<div id="qunit-fixture">test markup, will be hidden</div>

		{% if error %}<div id="error">{{error|default:""}}</div>{% endif %}
		<div id="results"></div>
		<div id="tabs">
			<ul>
				<li><a href="#tabs-1">{% trans 'Frame' %}</a></li>
				<li>
					<a href="#tabs-2">{% trans 'Tools console' %}</a>
					<div style="width:16px; height: 16px; float: left; padding: .5em 0;">
						<img id="tabs-2-loading" src="{{ loader }}/loading.gif" style="display:none;">
					</div>
					</li>
				<li><a href="#tabs-3">{% trans 'QUnit console' %}</a></li>
			</ul>
			<div id="tabs-1">
				<iframe id="frame" name="frame">
					<html>
						<head>
						</head>
						<body>
						</body>
					</html>
				</iframe>
			</div>
			<div id="tabs-2">
				<div id="powershell-console">
				</div>
			</div>
			<div id="tabs-3">
				<div id="qunit-console">
				</div>
			</div>
		</div>
	</body>
</html>
